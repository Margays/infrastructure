# network interface settings; autogenerated
# Please do NOT modify this file directly, unless you know what
# you're doing.
#
# If you want to manage parts of the network configuration manually,
# please utilize the 'source' or 'source-directory' directives to do
# so.
# PVE will preserve these directives, but will NOT read its network
# configuration from sourced files, so do not attempt to move any of
# the PVE managed interfaces into external files!

auto lo
iface lo inet loopback

# Interfaces
{% for interface in proxmox_network_interfaces %}
auto {{ interface.name }}
iface {{ interface.name }} inet manual

{% endfor %}

# Bonds
{% for bond in proxmox_network_bonds %}
auto {{ bond.name }}
iface {{ bond.name }} inet manual
        ovs_bonds {{ bond.slaves | join(" ") }}
        ovs_type OVSBond
        ovs_bridge vmbr0
        ovs_options bond_mode=active-backup

{% endfor %}

# Bridges
{% for bridge in proxmox_network_bridges %}
auto {{ bridge.name }}
iface {{ bridge.name }} inet static
        address {{ bridge.address }}/{{ bridge.netmask }}
        gateway {{ bridge.gateway }}
        ovs_type OVSBridge
        ovs_ports {{ bridge.bridge_ports | join(" ") }}

{% endfor %}

source /etc/network/interfaces.d/*
